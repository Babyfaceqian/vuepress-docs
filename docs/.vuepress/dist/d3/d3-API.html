<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>D3 API详解 | Notebook</title>
    <meta name="description" content="前端笔记">
    
    
    <link rel="preload" href="/assets/css/0.styles.e5c86877.css" as="style"><link rel="preload" href="/assets/js/app.64fb6d0a.js" as="script"><link rel="preload" href="/assets/js/2.5d9cdd2a.js" as="script"><link rel="preload" href="/assets/js/7.9fe8b1a7.js" as="script"><link rel="prefetch" href="/assets/js/10.5b487c09.js"><link rel="prefetch" href="/assets/js/11.893b2779.js"><link rel="prefetch" href="/assets/js/12.5daeeda3.js"><link rel="prefetch" href="/assets/js/13.cbbbe4bc.js"><link rel="prefetch" href="/assets/js/14.cd7454ce.js"><link rel="prefetch" href="/assets/js/15.1d8a976b.js"><link rel="prefetch" href="/assets/js/16.e625795a.js"><link rel="prefetch" href="/assets/js/3.33696b86.js"><link rel="prefetch" href="/assets/js/4.0e68f4b8.js"><link rel="prefetch" href="/assets/js/5.d6c1d76b.js"><link rel="prefetch" href="/assets/js/6.892c29eb.js"><link rel="prefetch" href="/assets/js/8.26fb9c1a.js"><link rel="prefetch" href="/assets/js/9.9daa6b8c.js">
    <link rel="stylesheet" href="/assets/css/0.styles.e5c86877.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">Notebook</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <!----></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><!---->  <ul class="sidebar-links"><li><a href="/d3/d3-API.html" class="active sidebar-link">D3 API详解</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/d3/d3-API.html#api总览" class="sidebar-link">API总览</a></li><li class="sidebar-sub-header"><a href="/d3/d3-API.html#selection" class="sidebar-link">selection</a></li></ul></li><li><a href="/d3/d3-canvas-axis.html" class="sidebar-link">d3与canvas坐标系</a></li><li><a href="/d3/d3-react.html" class="sidebar-link">d3与react</a></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="d3-api详解"><a href="#d3-api详解" aria-hidden="true" class="header-anchor">#</a> D3 API详解</h1> <h2 id="api总览"><a href="#api总览" aria-hidden="true" class="header-anchor">#</a> API总览</h2> <table><thead><tr><th>内容</th> <th>简介</th></tr></thead> <tbody><tr><td>核心（Core）</td> <td>包括选择器、过渡、数据处理、本地化、颜色等</td></tr> <tr><td>比例尺（Scales）</td> <td>在数据编码和视觉编码之间转换</td></tr> <tr><td>可缩放矢量图形</td> <td>提供用于创建可伸缩矢量图形的使用工具</td></tr> <tr><td>事件（Time）</td> <td>解析或而是花时间，计算日历的事件间隔等。</td></tr> <tr><td>布局（Layout）</td> <td>推导定位元素的辅助数据</td></tr> <tr><td>地理（Geography）</td> <td>球面坐标，经纬度运算</td></tr> <tr><td>几何（Geometry）</td> <td>提供绘制2D几何图形的实用工具</td></tr> <tr><td>行为（Behaviors）</td> <td>可重用的交互行为</td></tr></tbody></table> <h2 id="selection"><a href="#selection" aria-hidden="true" class="header-anchor">#</a> selection</h2> <ul><li>selection.attr(name[,value])</li></ul> <p><code>value</code> 可以为常数、函数，如果为函数，这个函数会有两个参数：<code>d</code> 代表当前元素绑定的数据，<code>i</code> 代表索引。如果 <code>value</code> 参数的值为 <code>null</code>，则移除指定的属性。D3中元素的大多数操作都支持多属性设置。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code>selection<span class="token punctuation">.</span><span class="token function">attr</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  <span class="token function-variable function">x</span><span class="token punctuation">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">d<span class="token punctuation">,</span>i</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token keyword">return</span> d<span class="token punctuation">}</span><span class="token punctuation">,</span>
  y<span class="token punctuation">:</span> <span class="token number">20</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><ul><li>selection.data([values[,key]])</li></ul> <p>给当前选定的所有元素依次绑定 <code>values</code> 数组中的数据，数据被存储在元素的“<strong>data</strong>”属性中。</p> <ul><li>selection.datum([value])</li></ul> <p>与data的区别是，datum不能使用enter和exit， 能够访问html5自定义数据属性，即data-*属性，充当数据。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code>d3<span class="token punctuation">.</span><span class="token function">selectAll</span><span class="token punctuation">(</span><span class="token string">'div'</span><span class="token punctuation">)</span>
<span class="token punctuation">.</span><span class="token function">datum</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>dataset<span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">.</span><span class="token function">text</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">d</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token keyword">return</span> d<span class="token punctuation">.</span>username<span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><ul><li>selection.call(function[,arguments...])</li></ul> <p>为selection调用函数，方便链式操作。</p> <ul><li><p>selection.empty()</p> <p>如果当前选择为空，则返回true。一个选择是空，意味着它不包含任何元素或就是 <code>null</code> 元素。</p></li> <li><p>selection.node()</p> <p>返回当前选择的第一个非空的元素。如果选择为空，则返回 <code>null</code>。</p></li> <li><p>selection.size()</p></li> <li><p>transition.attr(name, value)</p></li></ul> <p>属性值过渡到value</p> <ul><li>transition.attrTween(name, tween)</li></ul> <p>用指定的补间（tween）函数，过渡指定属性的值。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">function</span> <span class="token function">tween</span><span class="token punctuation">(</span><span class="token parameter">d<span class="token punctuation">,</span> i<span class="token punctuation">,</span> a</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> d3<span class="token punctuation">.</span><span class="token function">interpolateNumber</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span> <span class="token number">2</span><span class="token operator">*</span>a<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><ul><li>transition.styleTween(name, tween[,priority])</li></ul> <p>用指定的补间函数，过渡指定的css样式的值。可选参数 <code>priority</code> 可以被指定为 <code>null</code> 或者字符串&quot;important&quot;（没有感叹号）。</p> <ul><li>transition.text(value)</li></ul> <p>替换文本</p> <ul><li>transition.tween(name, factory)</li></ul> <p>给指定的名称（属性和样式名）注册一个自定义的补间函数。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code>d3<span class="token punctuation">.</span><span class="token function">select</span><span class="token punctuation">(</span><span class="token string">&quot;text&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">transition</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">.</span><span class="token function">duration</span><span class="token punctuation">(</span><span class="token number">7500</span><span class="token punctuation">)</span>
<span class="token punctuation">.</span><span class="token function">tween</span><span class="token punctuation">(</span><span class="token string">&quot;text&quot;</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">var</span> interpolate <span class="token operator">=</span> d3<span class="token punctuation">.</span><span class="token function">interpolate</span><span class="token punctuation">(</span>d3<span class="token punctuation">.</span><span class="token function">select</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">text</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">return</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">t</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    d3<span class="token punctuation">.</span><span class="token function">select</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">text</span><span class="token punctuation">(</span><span class="token function">interpolate</span><span class="token punctuation">(</span>t<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><ul><li>transition.remove()</li></ul> <p>在过渡结束时删除选定的元素。</p> <ul><li>transition.select(selector)</li></ul> <p>在当前过渡的每个元素中，选择与指定的选择字符串匹配的第一个元素。</p> <ul><li>transition.transition()</li></ul> <p>在同样的选中元素上创建一个新的过渡，在当前过渡结束后启动。新的过渡继承当前过渡的持续时间和延迟时间。这可以用来定义链式过渡，无需监听过渡结束事件。</p> <ul><li>transition.call(function[, arguments...])</li></ul> <p>调用指定的函数一次，可传入一些可选的参数。call会将当前对象作为第一个参数传入调用的函数中。</p> <ul><li>transition.empty()</li></ul> <p>如果当前过渡的选择是空的，则返回true。</p> <ul><li>transition.node()</li></ul> <p>返回当前过渡选择的第一个飞空元素。如果过渡为空，则返回null。</p> <ul><li>transition.size()</li></ul> <p>返回当前过渡选择的元素总数。</p> <ul><li>d3.ease(type[,arguments...])</li></ul> <p>由指定的类型和可选参数返回一个内置的缓动函数。</p> <ul><li>d3.timer(function[,delay[,time]])</li></ul> <p>启动一个自定义动画计时器，重复地调用指定的函数，知道它返回true。</p> <ul><li>d3.interpolate(a,b)</li></ul> <p>返回一个介于a和b之间的默认插值器。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code>svg<span class="token punctuation">.</span><span class="token function">select</span><span class="token punctuation">(</span><span class="token string">'circle'</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">transition</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">duration</span><span class="token punctuation">(</span><span class="token number">1000</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">styleTween</span><span class="token punctuation">(</span><span class="token string">'fill'</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">d<span class="token punctuation">,</span> i<span class="token punctuation">,</span> val</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> d3<span class="token punctuation">.</span><span class="token function">interpolate</span><span class="token punctuation">(</span><span class="token string">'green'</span><span class="token punctuation">,</span> <span class="token string">'orange'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><ul><li>interpolate(t)</li></ul> <p>对在区间[0, 1]中一个给定的参数t，返回对应的插入值。插值器通常结合比例尺一起使用，将值从定义域映射到值域。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">var</span> inter <span class="token operator">=</span> d3<span class="token punctuation">.</span><span class="token function">interpolate</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'0.5 --&gt; '</span> <span class="token operator">+</span> <span class="token function">inter</span><span class="token punctuation">(</span><span class="token number">0.5</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 返回0.5 --&gt; 5.5</span>
</code></pre></div><ul><li>d3.interpolateNumber(a, b)</li></ul> <p>返回一个a、b两个数字之间的数字插值器。返回的插值器相当于：</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">function</span> <span class="token function">interpolate</span><span class="token punctuation">(</span><span class="token parameter">t</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> a <span class="token operator">*</span> <span class="token punctuation">(</span> <span class="token number">1</span> <span class="token operator">-</span> t <span class="token punctuation">)</span> <span class="token operator">+</span> b <span class="token operator">*</span> t<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><ul><li>d3.interpolateRound(a, b)</li></ul> <p>返回一个a和b两个数字之间的数字插值器。返回的结果四舍五入为最近的整数。</p> <ul><li>d3.interpolateString(a, b)</li></ul> <p>返回一个a和b两个字符串之间的字符串插值器；字符串插值器会自动寻找嵌入在a和b里的数字，非数字部分保持不变。例如从'1px'到'10px'。</p> <ul><li>d3.interpolateRgb(a, b)</li></ul> <p>返回一个a和b两种颜色值之间的RGB颜色空间插值器。</p> <ul><li>d3.interpolateArray(a, b)</li></ul> <p>返回一个在两个数组a和b之间的数组插值器。在内部创建一个和b相同长度的数组模板，对于b中的每一个元素，如果在a中存在一个相应的元素，则计算插值，如果没有就用b的值。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">var</span> interArr <span class="token operator">=</span> d3<span class="token punctuation">.</span><span class="token function">interpolateArray</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">10</span><span class="token punctuation">,</span><span class="token number">100</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">interArr</span><span class="token punctuation">(</span><span class="token number">0.5</span><span class="token punctuation">)</span> <span class="token comment">// 返回[0.5, 5.5, 100]</span>
</code></pre></div><ul><li>d3.interpolateObject(a, b)</li></ul> <p>类似interpolateArray。</p> <ul><li>d3.interpolateTransform(a, b)</li></ul> <p>返回一个由a和b表示的二维仿射变换之间的插值器。每个变换都被分解成一个平移、旋转、x斜切和缩放的标准表示。然后插入这些变换的成分。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">var</span> start <span class="token operator">=</span> d3<span class="token punctuation">.</span><span class="token function">transform</span><span class="token punctuation">(</span><span class="token string">'translate(240, 240)scale(0)'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> end <span class="token operator">=</span> d3<span class="token punctuation">.</span><span class="token function">transform</span><span class="token punctuation">(</span><span class="token string">'translate(480, 480)scale(23)rotate(180)'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> interTrans <span class="token operator">=</span> d3<span class="token punctuation">.</span><span class="token function">interpolateTransform</span><span class="token punctuation">(</span>start<span class="token punctuation">,</span> end<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">interTrans</span><span class="token punctuation">(</span><span class="token number">0.5</span><span class="token punctuation">)</span>
</code></pre></div><ul><li>d3.interpolateZoom(a, b);</li></ul> <p>返回一个介于两个二位平面视图a和b之间的平滑的插值器。每个视图是由三个数字构成的数组：cx、cy和width定义的。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">var</span> view <span class="token operator">=</span> <span class="token punctuation">[</span>cx<span class="token punctuation">,</span> cy<span class="token punctuation">,</span> width<span class="token punctuation">]</span><span class="token punctuation">;</span>
</code></pre></div><ul><li>d3.ascending(a, b)</li></ul> <p>升序比较器函数，配合d3.sort使用</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code>d3<span class="token punctuation">.</span><span class="token function">select</span><span class="token punctuation">(</span><span class="token string">'svg'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">selectAll</span><span class="token punctuation">(</span><span class="token string">'text'</span><span class="token punctuation">)</span>
<span class="token punctuation">.</span><span class="token function">sort</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">a<span class="token punctuation">,</span> b</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> d3<span class="token punctuation">.</span><span class="token function">ascending</span><span class="token punctuation">(</span>a<span class="token punctuation">.</span>value<span class="token punctuation">,</span> b<span class="token punctuation">.</span>value<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><ul><li>d3.descending(a,b)</li></ul> <p>降序比较器函数</p> <ul><li>d3.min(array[, accessor])</li></ul> <p>返回给定数组中自然排序最小的值。如果数组为空，返回undefined。如果指定了accessor参数，等同于咋自己算最小值之前调用了array.map(accessor)方法，即先对每一项元素做处理。不同于内置的Math.min方法，这个方法会忽略未定义的值。</p> <ul><li>d3.max(array[, accessor])</li></ul></div> <footer class="page-edit"><!----> <!----></footer> <div class="page-nav"><p class="inner"><!----> <span class="next"><a href="/d3/d3-canvas-axis.html">
          d3与canvas坐标系
        </a>
        →
      </span></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/assets/js/app.64fb6d0a.js" defer></script><script src="/assets/js/2.5d9cdd2a.js" defer></script><script src="/assets/js/7.9fe8b1a7.js" defer></script>
  </body>
</html>
